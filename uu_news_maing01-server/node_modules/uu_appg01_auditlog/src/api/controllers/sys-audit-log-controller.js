"use strict";

const SysAuditLogAbl = require("../../abl/sys-audit-log-abl.js");
const AccessDenied = require("uu_appg01_core-appserver").AccessDenied;

class SysAuditLogController {
  static async listAuditLogRecordsByTimeAndSpp(ucEnv) {
    return await SysAuditLogAbl.listAuditLogRecordsByTimeAndSpp(ucEnv.getUri().getAwid(), ucEnv.getDtoIn());
  }

  static async listMyAuditLogRecordsByTime(ucEnv) {
    if (ucEnv.getSession()) {
      let loa = Number(ucEnv.getSession().getAuthenticationLevelOfAssurance());
      if (isNaN(loa)) {
        loa = 0;
      }
      if (loa == 0) {
        throw new AccessDenied("Logged user is not authorized to run use case.");
      }
    }

    return await SysAuditLogAbl.listMyAuditLogRecordsByTime(
      ucEnv.getUri().getAwid(),
      ucEnv.getSession(),
      ucEnv.getDtoIn()
    );
  }

  static async deleteAuditLogRecordsBeforeTime(ucEnv) {
    return await SysAuditLogAbl.deleteAuditLogRecordsBeforeTime(ucEnv.getUri().getAwid(), ucEnv.getDtoIn());
  }
}

module.exports = SysAuditLogController;
