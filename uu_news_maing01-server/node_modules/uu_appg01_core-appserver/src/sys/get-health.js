"use strict";

const Sys = require("./sys.js");
const AccessDenied = require("../error/access-denied.js");

/**
 * Provides server health status.
 */
class GetHealth {
  static call(ucEnv) {
    if (ucEnv.getSession()) {
      let loa = Number(ucEnv.getSession().getAuthenticationLevelOfAssurance());
      if (isNaN(loa)) {
        loa = 0;
      }
      if (loa == 0) {
        throw new AccessDenied("Logged user is not authorized to run use case.");
      }
    }

    let response = Object.assign({}, Sys.getAppInfo());
    response.serverStatus = "OK";
    response.uuAppErrorMap = {};
    return response;
  }
}

module.exports = GetHealth;
